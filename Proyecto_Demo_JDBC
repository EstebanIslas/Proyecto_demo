/*
 * Islas Santos Esteban
 * Proyecto Demo Final -- Realiza movimientos de datos y captura, guarda, edita y elimina
 * TIC - 32
 * Universidad Tecnológica de Tulancingo.
 */
package proyecto;
//Librerías del proyecto
import java.awt.Component;
import java.sql.DriverManager;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;

public class JFProyectoDemo extends javax.swing.JFrame {
    /**
    *
    * @author EstebanIslasSantos
    */
    
    //Variables para la conexión.
    public String desicion = "";
    private Connection conexion;
    private Statement st;
    private ResultSet rs;
    
    //Metodo que Realiza la conexión de base de datos
    public void Conectar() {
        try {
            conexion = DriverManager.getConnection("jdbc:mysql://localhost/proyect_demo", "root", ""); //realiza la conexion
            st = conexion.createStatement();

            rs = st.executeQuery("Select * from productos"); //realiza la consulta de datos de la bd

            rs.next(); //

            this.jtf_id_producto.setText(rs.getString("id_producto"));
            this.jtf_nombre_producto.setText(rs.getString("nombre_producto"));
            this.jtf_marca.setText(rs.getString("marca"));
            this.jtf_precio_compra.setText(rs.getString("precio_compra"));
            this.jtf_existencia.setText(rs.getString("existencia"));

        } catch (SQLException err) {
            JOptionPane.showMessageDialog(null, "Error " + err.getMessage());
        }
    }
    
    public void habilitardatos(boolean act){ //Habilito los datos con la variable act
        jtf_id_producto.setEnabled(act);
        jtf_nombre_producto.setEnabled(act);
        jtf_precio_compra.setEnabled(act);
        jtf_marca.setEnabled(act);
        jtf_existencia.setEnabled(act);
    }
    
    public void uso_de_controles(boolean ctrl){
        for (Component component : jp_control_movimiento.getComponents()) {
            component.setEnabled(ctrl);
        }
    }
    
    public void limpiar_datos(){
        this.jtf_id_producto.setText("");             
        this.jtf_nombre_producto.setText("");
        this.jtf_marca.setText("");
        this.jtf_precio_compra.setText("");
        this.jtf_existencia.setText("");
    }
    
    public JFProyectoDemo() {
        initComponents();
        this.Conectar(); //Llamo el metodo de conexion de la BD
        habilitardatos(false);//Desactivo los jtf para que no se puedan editar al primer momento de ejecución  
        jb_guardar.setEnabled(false);
        jb_cancelar.setEnabled(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        jp_datos = new javax.swing.JPanel();
        jl_id_producto = new javax.swing.JLabel();
        jl_nombre_producto = new javax.swing.JLabel();
        jl_marca = new javax.swing.JLabel();
        jl_precio_compra = new javax.swing.JLabel();
        jl_existencia = new javax.swing.JLabel();
        jtf_id_producto = new javax.swing.JTextField();
        jtf_nombre_producto = new javax.swing.JTextField();
        jtf_precio_compra = new javax.swing.JTextField();
        jtf_existencia = new javax.swing.JTextField();
        jtf_marca = new javax.swing.JTextField();
        jp_controles = new javax.swing.JPanel();
        jb_nuevo = new javax.swing.JButton();
        jb_editar = new javax.swing.JButton();
        jb_guardar = new javax.swing.JButton();
        jb_borrar = new javax.swing.JButton();
        jb_cancelar = new javax.swing.JButton();
        jp_control_movimiento = new javax.swing.JPanel();
        jb_primero = new javax.swing.JButton();
        jb_anterior = new javax.swing.JButton();
        jb_siguiente = new javax.swing.JButton();
        jb_ultimo = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Inventario de Productos");
        setResizable(false);

        jLabel1.setBackground(new java.awt.Color(245, 244, 244));
        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 36)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(153, 153, 153));
        jLabel1.setText("Productos");

        jp_datos.setBackground(new java.awt.Color(245, 244, 244));
        jp_datos.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jl_id_producto.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jl_id_producto.setText("ID:");

        jl_nombre_producto.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jl_nombre_producto.setText("Nombre:");

        jl_marca.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jl_marca.setText("Marca:");

        jl_precio_compra.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jl_precio_compra.setText("Precio");

        jl_existencia.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jl_existencia.setText("Existencia");

        jtf_id_producto.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N

        jtf_nombre_producto.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N

        jtf_precio_compra.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jtf_precio_compra.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                jtf_precio_compraKeyTyped(evt);
            }
        });

        jtf_existencia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jtf_existencia.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                jtf_existenciaKeyTyped(evt);
            }
        });

        jtf_marca.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N

        javax.swing.GroupLayout jp_datosLayout = new javax.swing.GroupLayout(jp_datos);
        jp_datos.setLayout(jp_datosLayout);
        jp_datosLayout.setHorizontalGroup(
            jp_datosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_datosLayout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(jp_datosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jl_id_producto)
                    .addComponent(jl_nombre_producto)
                    .addComponent(jl_marca)
                    .addComponent(jl_precio_compra)
                    .addComponent(jl_existencia))
                .addGap(41, 41, 41)
                .addGroup(jp_datosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jtf_id_producto)
                    .addComponent(jtf_nombre_producto)
                    .addComponent(jtf_precio_compra)
                    .addComponent(jtf_existencia, javax.swing.GroupLayout.DEFAULT_SIZE, 161, Short.MAX_VALUE)
                    .addComponent(jtf_marca))
                .addContainerGap(153, Short.MAX_VALUE))
        );
        jp_datosLayout.setVerticalGroup(
            jp_datosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_datosLayout.createSequentialGroup()
                .addGap(27, 27, 27)
                .addGroup(jp_datosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jp_datosLayout.createSequentialGroup()
                        .addGroup(jp_datosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jp_datosLayout.createSequentialGroup()
                                .addGroup(jp_datosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(jl_id_producto)
                                    .addComponent(jtf_id_producto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addComponent(jl_nombre_producto))
                            .addComponent(jtf_nombre_producto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addComponent(jl_marca)
                        .addGap(18, 18, 18)
                        .addComponent(jl_precio_compra))
                    .addGroup(jp_datosLayout.createSequentialGroup()
                        .addComponent(jtf_marca, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jtf_precio_compra, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(18, 18, 18)
                .addGroup(jp_datosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jl_existencia)
                    .addComponent(jtf_existencia, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(90, Short.MAX_VALUE))
        );

        jp_controles.setBackground(new java.awt.Color(245, 244, 244));
        jp_controles.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jb_nuevo.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jb_nuevo.setText("Nuevo");
        jb_nuevo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_nuevoActionPerformed(evt);
            }
        });

        jb_editar.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jb_editar.setText("Editar");
        jb_editar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_editarActionPerformed(evt);
            }
        });

        jb_guardar.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jb_guardar.setText("Guardar");
        jb_guardar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_guardarActionPerformed(evt);
            }
        });

        jb_borrar.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jb_borrar.setText("Borrar");
        jb_borrar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_borrarActionPerformed(evt);
            }
        });

        jb_cancelar.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jb_cancelar.setText("Cancelar");
        jb_cancelar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_cancelarActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jp_controlesLayout = new javax.swing.GroupLayout(jp_controles);
        jp_controles.setLayout(jp_controlesLayout);
        jp_controlesLayout.setHorizontalGroup(
            jp_controlesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jp_controlesLayout.createSequentialGroup()
                .addContainerGap(72, Short.MAX_VALUE)
                .addGroup(jp_controlesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jb_cancelar, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jb_borrar, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jb_guardar, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jb_editar, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jb_nuevo, javax.swing.GroupLayout.PREFERRED_SIZE, 97, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(69, 69, 69))
        );
        jp_controlesLayout.setVerticalGroup(
            jp_controlesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_controlesLayout.createSequentialGroup()
                .addGap(35, 35, 35)
                .addComponent(jb_nuevo)
                .addGap(18, 18, 18)
                .addComponent(jb_editar)
                .addGap(18, 18, 18)
                .addComponent(jb_guardar)
                .addGap(18, 18, 18)
                .addComponent(jb_borrar)
                .addGap(18, 18, 18)
                .addComponent(jb_cancelar)
                .addContainerGap(54, Short.MAX_VALUE))
        );

        jp_control_movimiento.setBackground(new java.awt.Color(245, 244, 244));
        jp_control_movimiento.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jb_primero.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jb_primero.setText("|<");
        jb_primero.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_primeroActionPerformed(evt);
            }
        });

        jb_anterior.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jb_anterior.setText("<");
        jb_anterior.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_anteriorActionPerformed(evt);
            }
        });

        jb_siguiente.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jb_siguiente.setText(">");
        jb_siguiente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_siguienteActionPerformed(evt);
            }
        });

        jb_ultimo.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jb_ultimo.setText(">|");
        jb_ultimo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_ultimoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jp_control_movimientoLayout = new javax.swing.GroupLayout(jp_control_movimiento);
        jp_control_movimiento.setLayout(jp_control_movimientoLayout);
        jp_control_movimientoLayout.setHorizontalGroup(
            jp_control_movimientoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jp_control_movimientoLayout.createSequentialGroup()
                .addContainerGap(38, Short.MAX_VALUE)
                .addComponent(jb_primero)
                .addGap(18, 18, 18)
                .addComponent(jb_anterior)
                .addGap(18, 18, 18)
                .addComponent(jb_siguiente)
                .addGap(18, 18, 18)
                .addComponent(jb_ultimo)
                .addGap(35, 35, 35))
        );
        jp_control_movimientoLayout.setVerticalGroup(
            jp_control_movimientoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_control_movimientoLayout.createSequentialGroup()
                .addGap(29, 29, 29)
                .addGroup(jp_control_movimientoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jb_primero)
                    .addComponent(jb_anterior)
                    .addComponent(jb_siguiente)
                    .addComponent(jb_ultimo))
                .addContainerGap(31, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(36, 36, 36)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jp_control_movimiento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jp_datos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(54, 54, 54)
                        .addComponent(jp_controles, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jLabel1))
                .addContainerGap(59, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(42, 42, 42)
                .addComponent(jLabel1)
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jp_controles, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jp_datos, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(18, 18, 18)
                .addComponent(jp_control_movimiento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(25, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>                        

    private void jb_nuevoActionPerformed(java.awt.event.ActionEvent evt) {                                         
        desicion = "nuevo";
        habilitardatos(true);
        uso_de_controles(false);
        limpiar_datos();
        jtf_id_producto.setEnabled(false);
        jb_nuevo.setEnabled(false);
        jb_editar.setEnabled(false);
        jb_borrar.setEnabled(false);
        jb_guardar.setEnabled(true);
        jb_cancelar.setEnabled(true);
    }                                        

    private void jb_primeroActionPerformed(java.awt.event.ActionEvent evt) {                                           
        try {
            if (rs.isFirst() == false) {
                rs.first();
                this.jtf_id_producto.setText(rs.getString("id_producto"));
                this.jtf_nombre_producto.setText(rs.getString("nombre_producto"));
                this.jtf_marca.setText(rs.getString("marca"));
                this.jtf_precio_compra.setText(rs.getString("precio_compra"));
                this.jtf_existencia.setText(rs.getString("existencia"));
            }
        } catch (Exception err) {
            JOptionPane.showMessageDialog(null, "Error " + err.getMessage());
        }
    }                                          

    private void jb_ultimoActionPerformed(java.awt.event.ActionEvent evt) {                                          
       try {
            if (rs.isLast() == false) {
                rs.last();
                this.jtf_id_producto.setText(rs.getString("id_producto"));
                this.jtf_nombre_producto.setText(rs.getString("nombre_producto"));
                this.jtf_marca.setText(rs.getString("marca"));
                this.jtf_precio_compra.setText(rs.getString("precio_compra"));
                this.jtf_existencia.setText(rs.getString("existencia"));
            }
        } catch (Exception err) {
            JOptionPane.showMessageDialog(null, "Error " + err.getMessage());
        }
    }                                         

    private void jb_siguienteActionPerformed(java.awt.event.ActionEvent evt) {                                             
       try {
            if(rs.isLast()==false) {
                rs.next(); 
                this.jtf_id_producto.setText(rs.getString("id_producto"));
                this.jtf_nombre_producto.setText(rs.getString("nombre_producto"));
                this.jtf_marca.setText(rs.getString("marca"));
                this.jtf_precio_compra.setText(rs.getString("precio_compra"));
                this.jtf_existencia.setText(rs.getString("existencia"));
            }
        } catch (Exception err) {
            JOptionPane.showMessageDialog(null, "Error " + err.getMessage());
        }
    }                                            

    private void jb_anteriorActionPerformed(java.awt.event.ActionEvent evt) {                                            
        try {
            if(rs.isFirst() == false) {
                rs.previous(); 
                this.jtf_id_producto.setText(rs.getString("id_producto"));
                this.jtf_nombre_producto.setText(rs.getString("nombre_producto"));
                this.jtf_marca.setText(rs.getString("marca"));
                this.jtf_precio_compra.setText(rs.getString("precio_compra"));
                this.jtf_existencia.setText(rs.getString("existencia"));
            }
        } catch (Exception err) {
            JOptionPane.showMessageDialog(null, "Error " + err.getMessage());
        }
    }                                           

    private void jb_guardarActionPerformed(java.awt.event.ActionEvent evt) {                                           
        if (desicion == "nuevo"){
            try {
                
                String nombre_producto = this.jtf_nombre_producto.getText();
                String marca_producto = this.jtf_marca.getText();
                float precio_compra = Float.parseFloat(this.jtf_precio_compra.getText());
                int existencia = Integer.parseInt(this.jtf_existencia.getText());
                if (precio_compra >= 0 && existencia >= 0){
                    st.executeUpdate("Insert into productos(nombre_producto,marca,precio_compra,existencia)" + " values ('" + nombre_producto + "','" + marca_producto + "','" + precio_compra + "','" + existencia + "');");

                    JOptionPane.showMessageDialog(this, "Producto Guardado Exitosamente!!");
                    this.Conectar();
                    uso_de_controles(true);
                    habilitardatos(false);
                    jb_nuevo.setEnabled(true);
                    jb_editar.setEnabled(true);
                    jb_borrar.setEnabled(true);
                    jb_guardar.setEnabled(false);
                    jb_cancelar.setEnabled(false);
                }else {
                    JOptionPane.showMessageDialog(this, "Número negativo intente de nuevo!!");
                }
            } catch (SQLException ex) {
                JOptionPane.showMessageDialog(this,"Error "+ex.getMessage()); 
            } catch (Exception ext){
                JOptionPane.showMessageDialog(this, "Tiene algun campo vacio o ingreso datos de diferente tipo, Intente de nuevo!!");
            }   
        }else if (desicion == "edicion"){
            try {
                String nombre_producto = this.jtf_nombre_producto.getText();
                String marca_producto = this.jtf_marca.getText();
                float precio_compra = Float.parseFloat(this.jtf_precio_compra.getText());
                int existencia = Integer.parseInt(this.jtf_existencia.getText());
                
                if (precio_compra >= 0 && existencia >= 0){
                    st.executeUpdate("UPDATE productos SET nombre_producto='" + nombre_producto + "',marca='" + marca_producto + "',precio_compra='" + precio_compra + "',existencia='" + existencia + "' WHERE id_producto=" + this.jtf_id_producto.getText());
                    JOptionPane.showMessageDialog(this, "Producto Editado y Guardado Exitosamente!!");
                    this.Conectar();
                    uso_de_controles(true);
                    habilitardatos(false);
                    jb_nuevo.setEnabled(true);
                    jb_editar.setEnabled(true);
                    jb_borrar.setEnabled(true);
                    jb_guardar.setEnabled(false);
                    jb_cancelar.setEnabled(false);
                }else {
                    JOptionPane.showMessageDialog(this, "Número negativo intente de nuevo!!");
                }
            } catch (SQLException ex) {
                JOptionPane.showMessageDialog(this,"Error "+ex.getMessage()); 
            } catch (Exception ext){
                JOptionPane.showMessageDialog(this, "Tiene algun campo vacio o ingreso datos de diferente tipo, Intente de nuevo!!");
            }
        }
    }                                          

    private void jb_borrarActionPerformed(java.awt.event.ActionEvent evt) {                                          
        try{
            st.executeUpdate("delete from productos where id_producto="+this.jtf_id_producto.getText());
            this.Conectar(); // Conecta con la Base De Datos
            uso_de_controles(true);
            jb_nuevo.setEnabled(true);
            jb_editar.setEnabled(true);
            jb_borrar.setEnabled(true);
            jb_guardar.setEnabled(false);
            jb_cancelar.setEnabled(false);
            JOptionPane.showMessageDialog(this, "Eliminación Exitosa!!");

        } catch(SQLException err){ 
            JOptionPane.showMessageDialog(null,"Error "+err.getMessage()); 
        }
    }                                         

    private void jb_editarActionPerformed(java.awt.event.ActionEvent evt) {                                          
        desicion = "edicion";
        habilitardatos(true);
        uso_de_controles(false);
        jtf_id_producto.setEnabled(false);
        jb_nuevo.setEnabled(false);
        jb_editar.setEnabled(false);
        jb_borrar.setEnabled(false);
        jb_guardar.setEnabled(true);
        jb_cancelar.setEnabled(true);
    }                                         

    private void jb_cancelarActionPerformed(java.awt.event.ActionEvent evt) {                                            
        this.Conectar();
        uso_de_controles(true);
        habilitardatos(false);
        jb_nuevo.setEnabled(true);
        jb_editar.setEnabled(true);
        jb_borrar.setEnabled(true);
        jb_guardar.setEnabled(false);
        jb_cancelar.setEnabled(false);
    }                                           

    private void jtf_precio_compraKeyTyped(java.awt.event.KeyEvent evt) {                                           
        char car = evt.getKeyChar (); // extraemos el dato que el usuario teclea y se guarda en evt
        if ((car<'0' || car >'9') && (car>'.')) evt.consume(); // detecta un caracter y no deja escribirlo
    }                                          

    private void jtf_existenciaKeyTyped(java.awt.event.KeyEvent evt) {                                        
        char car = evt.getKeyChar (); // extraemos el dato que el usuario teclea y se guarda en evt
        if ((car<'0' || car >'9') && (car>'.')) evt.consume(); // detecta un caracter y no deja escribirlo
    }
